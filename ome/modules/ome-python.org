#+TITLE: Python 配置

* install ipython
#+BEGIN_SRC emacs-lisp
  (when (not (executable-find "ipython"))
    (run-su-shell "sudo apt-get -y install ipython"))
#+END_SRC

* setting ipython
#+BEGIN_SRC emacs-lisp
  (when (executable-find "ipython")
    (setq
     python-shell-interpreter "ipython"
     python-shell-interpreter-args "-i --no-banner --simple-prompt"
     python-shell-prompt-regexp "In \\[[0-9]+\\]: "
     python-shell-prompt-output-regexp "Out\\[[0-9]+\\]: "
     ))
  (defun python-add-breakpoint ()
    "Add a break point"
    (interactive)
    (newline-and-indent)
    (insert "from IPython.core.debugger import Tracer;Tracer()()")
    (highlight-lines-matching-regexp "^[ ]*from IPython.core.debugger import Tracer;Tracer()()"))
  (add-hook 'python-mode-hook
            (lambda () (define-key python-mode-map (kbd "C-c C-b") 'python-add-breakpoint)))


  (defun python-interactive ()
    "Enter the interactive Python environment"
    (interactive)
    (progn
      (insert "!import code; code.interact(local=vars())")
      (move-end-of-line 1)
      (comint-send-input)))

  (global-set-key (kbd "C-c i") 'python-interactive)
#+END_SRC
